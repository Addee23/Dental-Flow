@page "{serviceId:int}"
@model DentalFlow.Pages.Bookings.CreateModel

@{
    ViewData["Title"] = "Boka tid";
}

<h2>Boka tid</h2>

<!-- Visa valideringsfel -->
<div asp-validation-summary="All" class="text-danger mb-3"></div>

<form method="post">

    <!-- Datumväljare -->
    <div class="mb-3">
        <label class="form-label">Välj datum</label>

        <select asp-for="BookingDate" class="form-control" onchange="this.form.submit()">
            @foreach (var d in Model.Dates)
            {
                if (d < DateTime.Today)
                {
                    <option disabled>@d.ToString("yyyy-MM-dd") (förbi)</option>
                }
                else
                {
                    <option value="@d.ToString("yyyy-MM-dd")"
                            selected="@(Model.BookingDate == d.ToString("yyyy-MM-dd") ? "selected" : null)">
                        @d.ToString("yyyy-MM-dd")
                    </option>
                }
            }
        </select>
    </div>

    <!-- Tider -->
    <div class="mb-3">
        <label class="form-label">Välj tid</label>

        <div class="d-flex gap-2 flex-wrap">
            @foreach (var t in Model.TimeSlots)
            {
                if (t.IsPast)
                {
                    <button type="button" class="btn btn-secondary disabled">@t.Time</button>
                }
                else
                {
                    <button type="submit"
                            name="SelectedTime"
                            value="@t.Time"
                            class="btn btn-outline-primary">
                        @t.Time
                    </button>
                }
            }
        </div>
    </div>

    <!-- Hidden fields -->
    <input type="hidden" asp-for="BookingDate" />
    <input type="hidden" asp-for="Booking.Name" />
    <input type="hidden" asp-for="Booking.Email" />
    <input type="hidden" asp-for="Booking.Phone" />
    <input type="hidden" asp-for="Booking.ServiceId" />

</form>
